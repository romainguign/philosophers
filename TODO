leaks in certain cases checkvalgrind